# API YAMDB

## Описание

API для получения информации и обсуждения наиболее интересных произведений.
Проект **YaMDb** собирает отзывы (**Review**) пользователей на произведения (**Titles**).

Произведения делятся на категории: «Книги», «Фильмы», «Музыка». Список категорий (**Category**) может быть расширен администратором (например, можно добавить категорию «Изобразительное искусство» или «Ювелирка»).

Произведению может быть присвоен жанр (**Genre**) из списка предустановленных (например, «Сказка», «Рок» или «Артхаус»). Новые жанры может создавать только администратор.
Пользователи оставляют к произведениям текстовые отзывы (**Review**) и ставят произведению оценку в диапазоне от одного до десяти (целое число); из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число). На одно произведение пользователь может оставить только один отзыв.

Аутентификация осуществляется посредством отправки пользователем своего адреса email, но который будет отправлен 6-значный код подтверждения. Пользователь должен будет ввести свой email-адрес и код подтверждение, отправленный на этот адрес. Если пользователь впервые осуществляет аутентификацию, то он будет сохранен в БД. Если аутентификация проходит успешно, то пользователю будет выдан JWT-токен.

## Пользовательские роли

-   **Аноним** — может просматривать описания произведений, читать отзывы и комментарии.
-   **Аутентифицированный пользователь (user)** — может, как и **Аноним**, читать всё, дополнительно он может публиковать отзывы и ставить оценку произведениям, может комментировать чужие отзывы; может редактировать и удалять свои отзывы и комментарии. Эта роль присваивается по умолчанию каждому новому пользователю.
-   **Модератор (moderator)** — те же права, что и у **Аутентифицированного пользователя** плюс право удалять любые отзывы и комментарии.
-   **Администратор (admin)** — полные права на управление всем контентом проекта. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.
-   **Суперюзер Django** — обладает правами **администратора (admin)**

## Алгоритм аутентификации пользователей

Пользователь отправляет POST-запрос с параметром `email` на эндпоинт `/api/v1/auth/send_confirm_code/`.

**YaMDB** отправляет письмо с кодом подтверждения (`confirmation_code`) на адрес `email`.

Пользователь отправляет POST-запрос с параметрами `email` и `confirmation_code` на эндпоинт `/api/v1/auth/token/`, в ответе на запрос ему приходит token (JWT-токен).

При желании пользователь отправляет PATCH-запрос на эндпоинт `/api/v1/users/me/` и заполняет поля в своём профайле (описание полей — в документации).

## Стек технологий:

-   `Python 3.12`
-   `Django REST framework 3.15`
-   `Django 5`
-   `django-filter 24.3`
-   `Gunicorn 23.0`
-   `JWT`
-   `Redis`
-   `Celery`
-   `NGINX`
-   `Docker`
-   `Docker Compose`
-   `PostgreSQL`
-   `GIT`

## Документация и возможности API:

К проекту подключен redoc. Для просмотра документации используйте эндпойнт `/redoc/`

## Примечания

В данный момент проект осуществляет вывод email в консоль терминала.

## Запуск проекта в `Docker`

Клонируйте репозиторий:

```bash
git clone git@github.com:bissaliev/YaMDb.git
```

Перейдите в корень проекта:

```bash
cd YaMDB/
```

Создайте файл `.env` и определите в нем переменные:

```
DATABASE=postgres
DB_ENGINE=django.db.backends.postgresql
DB_NAME=postgres
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
DB_HOST=db
DB_PORT=5432
REDIS_SERVER=redis://redis:6379/0
```

Перейдите в директорию с файлом `docker-compose.yaml`:

```bash
cd YaMDb/infra/
```

Запустите docker compose:

```bash
docker compose up --build
```

После того, как `docker compose` запустит все сервисы, запустится `bash`-скрипт ,который выполнит миграции, соберет статику и загрузит первоначальные данные.

Чтобы остановить контейнеры нажмите клавиши `Ctrl + C` и выполните команду:

```bash
docker compose down -v
```

## Разработчик:

[**Биссалиев Олег**](https://github.com/bissaliev)
